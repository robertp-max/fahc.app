<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAHC | Accounting & Revenue Command Center</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Roboto Font -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: '#1B263B',
                        gold: '#C5A059',
                        garnet: '#7B241C',
                        cream: '#F5F5F0',
                        slate: '#475569',
                    },
                    fontFamily: {
                        sans: ['Roboto', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%;
            height: 300px;
            margin-left: auto;
            margin-right: auto;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #F5F5F0; 
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #C5A059; 
            border-radius: 3px;
        }

        .nav-link.active {
            background-color: #C5A059;
            color: #1B263B;
            font-weight: 700;
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-cream text-navy font-sans antialiased overflow-hidden">

    <!-- Chosen Palette: FAHC Brand (Navy, Gold, Garnet, Cream) -->
    <!-- Application Structure Plan: 
         - Vertical Sidebar for primary navigation between Dashboard, Revenue Cycle, and Admin.
         - Dashboard: High-level metrics for team accountability (the "Working Hard" view).
         - Revenue Cycle: Action-oriented view for manual reminders and uploads.
         - Access Control: Research-based UAM matrix.
         - Specs: Detailed textual requirements for developers.
         Chosen because accounting users require dense information display paired with clear action triggers.
    -->

    <div class="flex h-screen w-full">
        <!-- Sidebar -->
        <aside class="w-64 bg-navy text-white flex-shrink-0 flex flex-col shadow-2xl z-20">
            <div class="p-6 border-b border-white/10 flex items-center gap-3">
                <div class="w-10 h-10 bg-gold rounded flex items-center justify-center font-black text-navy text-xl">F</div>
                <div>
                    <h1 class="font-black text-lg leading-tight tracking-tighter">CareFinance</h1>
                    <p class="text-[10px] text-gold uppercase tracking-widest font-bold">Accounting Portal</p>
                </div>
            </div>

            <nav class="flex-1 py-8 px-4 space-y-2 overflow-y-auto custom-scrollbar">
                <button onclick="switchView('dashboard')" class="nav-link w-full text-left px-4 py-3 rounded-md flex items-center gap-3 text-sm transition-all hover:bg-white/5 active">
                    <span>üìä</span> Performance Dashboard
                </button>
                <button onclick="switchView('revenue')" class="nav-link w-full text-left px-4 py-3 rounded-md flex items-center gap-3 text-sm transition-all hover:bg-white/5">
                    <span>üí≥</span> Revenue Management
                </button>
                <button onclick="switchView('access')" class="nav-link w-full text-left px-4 py-3 rounded-md flex items-center gap-3 text-sm transition-all hover:bg-white/5">
                    <span>üîê</span> User Access (UAM)
                </button>
                <button onclick="switchView('specs')" class="nav-link w-full text-left px-4 py-3 rounded-md flex items-center gap-3 text-sm transition-all hover:bg-white/5">
                    <span>üìã</span> Functional Specs
                </button>
            </nav>

            <div class="p-6 bg-black/20 text-xs text-gray-400 border-t border-white/5">
                <p>Accounting Admin: Alex M.</p>
                <p class="mt-1">Last Sync: Today, 09:15 AM</p>
            </div>
        </aside>

        <!-- Main Workspace -->
        <main class="flex-1 flex flex-col min-w-0 bg-white shadow-inner">
            <!-- Header -->
            <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 z-10">
                <h2 id="view-title" class="text-xl font-bold uppercase tracking-tight text-navy">Performance Dashboard</h2>
                <div class="flex items-center gap-4">
                    <span class="text-xs bg-emerald-100 text-emerald-800 px-2 py-1 rounded font-bold">System Status: Active</span>
                    <button class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-sm">üîî</button>
                </div>
            </header>

            <!-- Content Area -->
            <div id="content" class="flex-1 overflow-y-auto p-8 custom-scrollbar">
                <!-- Content will be injected here -->
            </div>
        </main>
    </div>

    <!-- Toast Notification System -->
    <div id="toast" class="fixed bottom-8 right-8 bg-navy text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-4 border-l-4 border-gold transform translate-y-32 opacity-0 transition-all duration-300">
        <span class="text-2xl" id="toast-icon">üöÄ</span>
        <div>
            <p class="font-bold text-sm" id="toast-title">Success</p>
            <p class="text-xs text-gray-300" id="toast-body">Operation completed.</p>
        </div>
    </div>

    <!-- TEMPLATES -->

    <!-- Dashboard Template -->
    <template id="view-dashboard">
        <div class="space-y-8 animate-fade-in">
            <div class="bg-navy p-6 rounded-xl text-white flex justify-between items-center shadow-lg">
                <div>
                    <h3 class="text-2xl font-bold">Accounting Monthly Goals</h3>
                    <p class="text-gold text-sm font-medium">Goal: $1.2M Collected Revenue | 95% Reporting Compliance</p>
                </div>
                <div class="flex gap-4">
                    <div class="text-center">
                        <p class="text-[10px] text-gray-400 uppercase font-bold tracking-widest">Days to Close</p>
                        <p class="text-xl font-bold">12</p>
                    </div>
                </div>
            </div>

            <!-- KPI Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white p-6 rounded-xl border border-gray-100 shadow-sm">
                    <p class="text-xs font-bold text-slate uppercase tracking-widest">DSO (Days Sales Out.)</p>
                    <h4 class="text-3xl font-black text-navy mt-2">28.4</h4>
                    <p class="text-xs text-emerald-600 mt-2 font-bold">‚ñº 2.1 days vs LY</p>
                </div>
                <div class="bg-white p-6 rounded-xl border border-gray-100 shadow-sm">
                    <p class="text-xs font-bold text-slate uppercase tracking-widest">Reporting Comp.</p>
                    <h4 class="text-3xl font-black text-navy mt-2">87%</h4>
                    <p class="text-xs text-garnet mt-2 font-bold">8% below target</p>
                </div>
                <div class="bg-white p-6 rounded-xl border border-gray-100 shadow-sm">
                    <p class="text-xs font-bold text-slate uppercase tracking-widest">Unverified GAP</p>
                    <h4 class="text-3xl font-black text-garnet mt-2">142</h4>
                    <p class="text-xs text-slate mt-2 font-bold">Pending verification</p>
                </div>
                <div class="bg-white p-6 rounded-xl border border-gray-100 shadow-sm">
                    <p class="text-xs font-bold text-slate uppercase tracking-widest">Collection Eff.</p>
                    <h4 class="text-3xl font-black text-navy mt-2">91.2%</h4>
                    <p class="text-xs text-emerald-600 mt-2 font-bold">‚ñ≤ 0.5% MTM</p>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-xl border border-gray-100 shadow-sm">
                    <h4 class="font-bold text-navy mb-6 uppercase tracking-widest text-sm">Revenue Collection Trend</h4>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-8 rounded-xl border border-gray-100 shadow-sm">
                    <h4 class="font-bold text-navy mb-6 uppercase tracking-widest text-sm">Provider Reporting Funnel</h4>
                    <div class="chart-container">
                        <canvas id="complianceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Revenue Cycle Template -->
    <template id="view-revenue">
        <div class="space-y-8 animate-fade-in">
            <div class="bg-gray-50 border border-gray-200 p-6 rounded-xl">
                <h3 class="text-lg font-bold text-navy">Revenue Workflow Actions</h3>
                <p class="text-sm text-slate mt-1">Manage reminders, upload external aging data, and apply revenue adjustments.</p>
                
                <div class="flex flex-wrap gap-4 mt-6">
                    <button onclick="showToast('Reminders Sent', 'Automated reminders sent to 45 overdue providers.', 'üìß')" class="bg-navy text-white px-6 py-3 rounded-lg font-bold text-xs uppercase tracking-widest hover:bg-slate transition-all shadow-lg">
                        Send Monthly Reminders
                    </button>
                    <button onclick="showToast('Upload UI', 'Opening Revenue CSV Ingestion portal...', 'üì•')" class="bg-gold text-navy px-6 py-3 rounded-lg font-bold text-xs uppercase tracking-widest hover:bg-opacity-90 transition-all shadow-lg">
                        Upload Revenue CSV
                    </button>
                    <button onclick="showToast('Aging Sync', 'Syncing with External Payment Processor...', 'üìä')" class="bg-white border-2 border-navy text-navy px-6 py-3 rounded-lg font-bold text-xs uppercase tracking-widest hover:bg-gray-50 transition-all">
                        Upload Aging Manually
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="bg-navy px-8 py-4 flex justify-between items-center">
                    <h4 class="text-white font-bold uppercase text-xs tracking-[3px]">Provider Ledger Watchlist</h4>
                    <div class="flex gap-2">
                        <input type="text" placeholder="Filter by Provider..." class="text-xs px-3 py-1 rounded bg-white/10 text-white border border-white/20 outline-none">
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-gray-100 text-slate uppercase text-[10px] font-black tracking-widest border-b border-gray-200">
                                <th class="px-8 py-4">Provider / Community</th>
                                <th class="px-8 py-4">Status</th>
                                <th class="px-8 py-4">Reporting Rate</th>
                                <th class="px-8 py-4 text-right">Balance Due</th>
                                <th class="px-8 py-4 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 text-sm">
                            <tr class="hover:bg-gray-50 transition-colors">
                                <td class="px-8 py-6">
                                    <p class="font-bold text-navy">Sunrise Senior Living - Menlo Park</p>
                                    <p class="text-xs text-slate font-mono">ID: FAHC-9920</p>
                                </td>
                                <td class="px-8 py-6">
                                    <span class="bg-garnet/10 text-garnet px-3 py-1 rounded-full text-[10px] font-black uppercase">Overdue Report</span>
                                </td>
                                <td class="px-8 py-6">
                                    <div class="w-24 bg-gray-200 h-1.5 rounded-full mt-2">
                                        <div class="bg-gold h-1.5 rounded-full" style="width: 45%"></div>
                                    </div>
                                    <p class="text-[10px] text-slate mt-1 font-bold">45% Compliance</p>
                                </td>
                                <td class="px-8 py-6 text-right font-mono font-bold">$12,450.00</td>
                                <td class="px-8 py-6 text-center">
                                    <button onclick="showToast('Reminder Sent', 'Manual reminder triggered for Sunrise Living.', 'üìß')" class="text-navy hover:text-gold transition-colors font-bold text-xs underline">REMIND</button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition-colors">
                                <td class="px-8 py-6">
                                    <p class="font-bold text-navy">Brookdale Central Coast</p>
                                    <p class="text-xs text-slate font-mono">ID: FAHC-8812</p>
                                </td>
                                <td class="px-8 py-6">
                                    <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-[10px] font-black uppercase">Current</span>
                                </td>
                                <td class="px-8 py-6">
                                    <div class="w-24 bg-gray-200 h-1.5 rounded-full mt-2">
                                        <div class="bg-emerald-500 h-1.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                    <p class="text-[10px] text-slate mt-1 font-bold">100% Compliance</p>
                                </td>
                                <td class="px-8 py-6 text-right font-mono font-bold text-slate">$0.00</td>
                                <td class="px-8 py-6 text-center italic text-gray-400 text-xs">No action req.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- UAM Template -->
    <template id="view-access">
        <div class="space-y-8 animate-fade-in max-w-4xl">
            <div class="bg-white p-8 rounded-xl border border-gray-200 shadow-sm">
                <h3 class="text-xl font-bold text-navy mb-4 border-b-4 border-gold pb-2 inline-block">User Access Management (UAM)</h3>
                <p class="text-sm text-slate mb-8 leading-relaxed">
                    Permissions are managed via role-based access control (RBAC). Admin users can create roles, assign staff, and audit security logs for revenue changes.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <h4 class="font-black text-[10px] uppercase tracking-[2px] text-slate">Role Categories</h4>
                        <div class="space-y-2">
                            <div class="p-4 bg-gray-50 rounded-lg flex justify-between items-center border border-gray-100">
                                <div>
                                    <p class="font-bold text-sm">Accounting Admin</p>
                                    <p class="text-[10px] text-slate uppercase font-bold">Full Access + Audit Rights</p>
                                </div>
                                <span class="bg-navy text-white text-[10px] px-2 py-0.5 rounded">2 Users</span>
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg flex justify-between items-center border border-gray-100">
                                <div>
                                    <p class="font-bold text-sm">Accounts Receivable</p>
                                    <p class="text-[10px] text-slate uppercase font-bold">Upload + Reminder Access</p>
                                </div>
                                <span class="bg-navy text-white text-[10px] px-2 py-0.5 rounded">5 Users</span>
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg flex justify-between items-center border border-gray-100">
                                <div>
                                    <p class="font-bold text-sm">Auditor</p>
                                    <p class="text-[10px] text-slate uppercase font-bold">Read-Only + Export Rights</p>
                                </div>
                                <span class="bg-navy text-white text-[10px] px-2 py-0.5 rounded">1 User</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-navy text-white p-6 rounded-xl shadow-lg flex flex-col justify-center text-center">
                        <div class="text-3xl mb-4">üîê</div>
                        <h4 class="font-bold text-gold text-lg">Manage Permissions</h4>
                        <p class="text-xs text-gray-300 mt-2 mb-6">Create granular custom roles for third-party billing agencies or regional controllers.</p>
                        <button class="bg-gold text-navy py-3 rounded-lg font-black text-[10px] uppercase tracking-widest hover:bg-white transition-all">
                            Configure New Role
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Specs Template -->
    <template id="view-specs">
        <div class="max-w-4xl mx-auto space-y-12 animate-fade-in pb-20">
            <h3 class="text-3xl font-black text-navy border-b-8 border-gold pb-4 inline-block">Functional Requirements Spec</h3>
            
            <section class="space-y-6">
                <div class="flex items-start gap-4">
                    <span class="bg-gold text-navy w-8 h-8 rounded-full flex items-center justify-center font-black flex-shrink-0">1</span>
                    <div>
                        <h4 class="text-xl font-bold text-navy">Revenue Reporting Engine</h4>
                        <p class="text-sm text-slate mt-2 leading-relaxed">
                            Admins must have the ability to toggle automated monthly cycles. The system must trigger "Move-In Requests" on the 1st of every month to all providers with active referrals.
                        </p>
                        <ul class="list-disc pl-5 mt-4 space-y-2 text-xs text-slate">
                            <li><strong>Requirement:</strong> Manual override to send reminders to specific providers or sub-communities.</li>
                            <li><strong>Logic:</strong> If <em>Status</em> is not 'REPORTED' by Day 5, trigger escalation email to Regional Controller.</li>
                            <li><strong>Feature:</strong> Provider Portal must support CSV upload and manual entry for revenue amounts per LeadID.</li>
                        </ul>
                    </div>
                </div>

                <div class="flex items-start gap-4">
                    <span class="bg-gold text-navy w-8 h-8 rounded-full flex items-center justify-center font-black flex-shrink-0">2</span>
                    <div>
                        <h4 class="text-xl font-bold text-navy">Manual Aging & Verification</h4>
                        <p class="text-sm text-slate mt-2 leading-relaxed">
                            Since payments are often applied in external systems (NetSuite, QuickBooks), the portal must allow accountants to upload an "External Aging" file to sync balances.
                        </p>
                        <ul class="list-disc pl-5 mt-4 space-y-2 text-xs text-slate">
                            <li><strong>Requirement:</strong> System must map CSV <em>Provider_ID</em> to internal portal profiles.</li>
                            <li><strong>Validation:</strong> Highlight discrepancies where 'Projected Commission' exceeds 'Reported Revenue'.</li>
                            <li><strong>Feature:</strong> Flag communities as "Credit Hold" if aging exceeds 90 days.</li>
                        </ul>
                    </div>
                </div>

                <div class="flex items-start gap-4">
                    <span class="bg-gold text-navy w-8 h-8 rounded-full flex items-center justify-center font-black flex-shrink-0">3</span>
                    <div>
                        <h4 class="text-xl font-bold text-navy">Team Productivity Metrics</h4>
                        <p class="text-sm text-slate mt-2 leading-relaxed">
                            To ensure the accounting team is "Working Hard", the dashboard must track internal KPIs.
                        </p>
                        <ul class="list-disc pl-5 mt-4 space-y-2 text-xs text-slate">
                            <li><strong>KPI:</strong> Average time from "Referral Sent" to "Lead Verification".</li>
                            <li><strong>KPI:</strong> Collection Rate: (Revenue Received / Revenue Invoiced).</li>
                            <li><strong>KPI:</strong> Outreach Volume: Total manual reminders/calls logged per AR Specialist.</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </template>

    <!-- JS Logic -->
    <script>
        const contentDiv = document.getElementById('content');
        const viewTitle = document.getElementById('view-title');
        let activeCharts = [];

        function switchView(viewId) {
            // Clean up charts
            activeCharts.forEach(c => c.destroy());
            activeCharts = [];

            // Update Nav UI
            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.remove('active');
            });
            event.currentTarget?.classList?.add('active');

            // Set Title
            const titles = {
                'dashboard': 'Performance Dashboard',
                'revenue': 'Revenue Cycle & Aging',
                'access': 'User Access Management',
                'specs': 'Functional Requirements'
            };
            viewTitle.innerText = titles[viewId];

            // Load Template
            const template = document.getElementById(`view-${viewId}`);
            const clone = template.content.cloneNode(true);
            contentDiv.innerHTML = '';
            contentDiv.appendChild(clone);

            // Init charts if dashboard
            if (viewId === 'dashboard') {
                setTimeout(initCharts, 100);
            }
        }

        function initCharts() {
            // Visualization & Content Choices:
            // 1. Line Chart for Revenue Trend -> Compare monthly performance. 
            // 2. Horizontal Bar Chart for Compliance Funnel -> Compare reported vs missing by segment.
            // NO SVG graphics used. Canvas based Chart.js used.

            const ctxRevenue = document.getElementById('revenueChart').getContext('2d');
            const revChart = new Chart(ctxRevenue, {
                type: 'line',
                data: {
                    labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    datasets: [{
                        label: 'Collected Revenue ($)',
                        data: [840000, 910000, 1050000, 1100000, 950000, 1180000],
                        borderColor: '#C5A059',
                        backgroundColor: 'rgba(197, 160, 89, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: false, grid: { color: '#f1f1f1' } },
                        x: { grid: { display: false } }
                    }
                }
            });
            activeCharts.push(revChart);

            const ctxComp = document.getElementById('complianceChart').getContext('2d');
            const compChart = new Chart(ctxComp, {
                type: 'bar',
                data: {
                    labels: ['Independent', 'Assisted', 'Memory Care', 'Home Care'],
                    datasets: [{
                        label: 'Reported (%)',
                        data: [95, 82, 74, 89],
                        backgroundColor: '#1B263B',
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { max: 100, grid: { display: false } },
                        y: { grid: { display: false } }
                    }
                }
            });
            activeCharts.push(compChart);
        }

        function showToast(title, body, icon) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-title').innerText = title;
            document.getElementById('toast-body').innerText = body;
            document.getElementById('toast-icon').innerText = icon || 'üöÄ';

            toast.classList.remove('translate-y-32', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-32', 'opacity-0');
            }, 4000);
        }

        // Init App
        document.addEventListener('DOMContentLoaded', () => {
            switchView('dashboard');
        });
    </script>
</body>
</html>